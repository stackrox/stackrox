{
  "id": "fb8f8732-c31d-496b-8fb1-d5abe6056e27",
  "name": "Automount Default Service Account Token",
  "description": "Alert on deployments mounting the default service account kubernetes secret",
  "rationale": "Kubernetes default service account can be used to compromise clusters. You can disable the behaviour in the deployment configuration or use a dedicated service account to interact with the control plane from within the deployment.",
  "remediation": "Add `automountServiceAccountToken: false` or a value distinct from 'default' for the `serviceAccountName` key to the deployment's Pod configuration.",
  "categories": [
    "Security Best Practices",
    "Privileges"
  ],
  "lifecycleStages": [
    "DEPLOY"
  ],
  "severity": "MEDIUM_SEVERITY",
  "policyVersion": "1.1",
  "policySections": [
    {
      "policyGroups": [
        {
          "fieldName": "Automount Service Account Token",
          "values": [
            {
              "value": "true"
            }
          ]
        },
        {
          "fieldName": "Service Account",
          "values": [
            {
              "value": "default"
            }
          ]
        },
        {
          "fieldName": "Namespace",
          "negate": true,
          "values": [
            {
              "value": "kube-system"
            }
          ]
        }
      ]
    }
  ],
  "mitreAttackVectors": [
  ],
  "criteriaLocked": true,
  "mitreVectorsLocked": true,
  "isDefault": true
}
