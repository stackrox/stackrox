package features

//lint:file-ignore U1000 we want to introduce this feature flag unused.

var (
	// SourcedAutogeneratedIntegrations enables adding a "source" to autogenerated integrations.
	// TODO(ROX-20353): if this is enabled by default, make sure to address sensor reconciliation of ImageIntegration resources.
	SourcedAutogeneratedIntegrations = registerFeature(disabled|unchangeableInProd, "Enable autogenerated integrations with cluster/namespace/secret source", "ROX_SOURCED_AUTOGENERATED_INTEGRATIONS")

	// VulnMgmtWorkloadCVEs enables APIs and UI pages for the VM Workload CVE enhancements
	VulnMgmtWorkloadCVEs = registerFeature(enabled|unchangeableInProd, "Vuln Mgmt Workload CVEs", "ROX_VULN_MGMT_WORKLOAD_CVES")

	// StoreEventHashes stores the hashes of successfully processed objects we receive from Sensor into the database
	StoreEventHashes = registerFeature(enabled|unchangeableInProd, "Store Event Hashes", "ROX_STORE_EVENT_HASHES")

	// PreventSensorRestartOnDisconnect enables a new behavior in Sensor where it avoids restarting when the gRPC connection with Central ends.
	PreventSensorRestartOnDisconnect = registerFeature(enabled|unchangeableInProd, "Prevent Sensor restart on disconnect", "ROX_PREVENT_SENSOR_RESTART_ON_DISCONNECT")

	// ComplianceEnhancements enables APIs and UI pages for Compliance 2.0
	ComplianceEnhancements = registerFeature(enabled, "Compliance enhancements", "ROX_COMPLIANCE_ENHANCEMENTS")

	// ActiveVulnMgmt defines if the active vuln mgmt feature is enabled
	ActiveVulnMgmt = registerFeature(disabled, "Enable Active Vulnerability Management", "ROX_ACTIVE_VULN_MGMT")

	// VulnReportingEnhancements enables APIs and UI pages for VM Reporting enhancements including downloadable reports
	VulnReportingEnhancements = registerFeature(enabled, "Enable Vulnerability Reporting enhancements", "ROX_VULN_MGMT_REPORTING_ENHANCEMENTS")

	// UnifiedCVEDeferral enables APIs and UI pages for unified deferral workflow.
	UnifiedCVEDeferral = registerFeature(enabled, "Enable new unified Vulnerability deferral workflow", "ROX_VULN_MGMT_UNIFIED_CVE_DEFERRAL")

	// ClusterAwareDeploymentCheck enables roxctl deployment check to check deployments on the cluster level.
	ClusterAwareDeploymentCheck = registerFeature(enabled, "Enables cluster level check for the 'roxctl deployment check' command.", "ROX_CLUSTER_AWARE_DEPLOYMENT_CHECK")

	// WorkloadCVEsFixabilityFilters enables Workload CVE UI controls for fixability filters and default filters
	WorkloadCVEsFixabilityFilters = registerFeature(enabled, "Enables Workload CVE fixability filters", "ROX_WORKLOAD_CVES_FIXABILITY_FILTERS")

	// SensorReconciliationOnReconnect enables sensors to support reconciliation when reconnecting
	SensorReconciliationOnReconnect = registerFeature(enabled, "Enable Sensors to support reconciliation on reconnect", "ROX_SENSOR_RECONCILIATION")

	// AuthMachineToMachine allows to exchange ID tokens for Central tokens without requiring user interaction.
	AuthMachineToMachine = registerFeature(enabled, "Enable Auth Machine to Machine functionalities", "ROX_AUTH_MACHINE_TO_MACHINE")

	// PolicyCriteriaModal enables a modal for selecting policy criteria when editing a policy
	PolicyCriteriaModal = registerFeature(disabled, "Enable modal to select policy criteria when editing a policy", "ROX_POLICY_CRITERIA_MODAL")

	// SensorDeploymentBuildOptimization enables a performance improvement by skipping deployments processing when no dependency or spec changed
	SensorDeploymentBuildOptimization = registerFeature(enabled, "Enables a performance improvement by skipping deployments processing when no dependency or spec changed", "ROX_DEPLOYMENT_BUILD_OPTIMIZATION")

	// DeploymentVolumeSearch enables search on the volume fields of deployments
	_ = registerFeature(enabled, "Enables search on the volume fields of deployments", "ROX_DEPLOYMENT_VOLUME_SEARCH")

	// DeploymentSecretSearch enables search on the secret fields of deployments
	_ = registerFeature(enabled, "Enables search on the secret fields of deployments", "ROX_DEPLOYMENT_SECRET_SEARCH")

	// DeploymentEnvvarSearch enables search on the environment variable fields of deployments
	_ = registerFeature(enabled, "Enables search on the environment variable fields of deployments", "ROX_DEPLOYMENT_ENVVAR_SEARCH")

	// SecretFileSearch enables search on the file fields of secrets
	_ = registerFeature(enabled, "Enables search on the file fields of secrets", "ROX_SECRET_FILE_SEARCH")

	// SensorCapturesIntermediateEvents enables sensor to capture intermediate events when it is disconnected from central
	SensorCapturesIntermediateEvents = registerFeature(enabled, "Enables sensor to capture intermediate events when it is disconnected from central", "ROX_CAPTURE_INTERMEDIATE_EVENTS")

	// ScannerV4Support enables various capabilities associated with ACS + Clair consolidated scanner.
	ScannerV4Support = registerFeature(enabled|unchangeableInProd, "Enable Scanner V4 Support", "ROX_SCANNER_V4_SUPPORT")

	// ScannerV4 indicates Scanner V4 is installed and should be used as the default image scanner in Central/Sensor.
	ScannerV4 = registerFeature(disabled, "Enables Scanner V4 runtime functionality", "ROX_SCANNER_V4")

	// ScannerV4MultiBundle enables Scanner V4 to consume vulnerabilities using multi-bundle archives.
	ScannerV4MultiBundle = registerFeature(enabled, "Enables Scanner V4 to consume vulnerabilities using multi-bundle archives", "ROX_SCANNER_V4_MULTI_BUNDLE")

	// ComplianceHierachyControlData enables support for compliance hierarchy control data.
	ComplianceHierachyControlData = registerFeature(enabled, "Enable support to display and import the compliance hierarchy control data", "ROX_COMPLIANCE_HIERARCHY_CONTROL_DATA")

	// VulnMgmtNodePlatformCVEs enables new APIs and UI for VM 2.0 Node and Platform CVEs
	VulnMgmtNodePlatformCVEs = registerFeature(enabled, "Enables support for Node and Platform CVEs in VM 2.0", "ROX_VULN_MGMT_NODE_PLATFORM_CVES")

	// VulnMgmtLegacySnooze enables APIs and UI for the legacy VM 1.0 "snooze CVE" functionality in the new VM 2.0 sections
	VulnMgmtLegacySnooze = registerFeature(disabled, "Enables the ability to snooze Node and Platform CVEs in VM 2.0", "ROX_VULN_MGMT_LEGACY_SNOOZE")

	// ComplianceReporting enables support for compliance reporting.
	ComplianceReporting = registerFeature(enabled, "Enable support for V2 compliance reporting", "ROX_COMPLIANCE_REPORTING")

	// UnqualifiedSearchRegistries enables support for unqualified search registries and short name aliases.
	UnqualifiedSearchRegistries = registerFeature(disabled, "Enable support for unqualified search registries and short name aliases", "ROX_UNQUALIFIED_SEARCH_REGISTRIES")

	// ComplianceRemediationV2 enables the remediation feature of the compliance v2 integration.
	ComplianceRemediationV2 = registerFeature(enabled, "Enable Compliance Remediation feature", "ROX_COMPLIANCE_REMEDIATION")

	// SensorAggregateDeploymentReferenceOptimization enables a performance improvement by aggregating deployment references when the same reference is queued for processing
	SensorAggregateDeploymentReferenceOptimization = registerFeature(disabled, "Enables a performance improvement by aggregating deployment references when the same reference is queued for processing", "ROX_AGGREGATE_DEPLOYMENT_REFERENCE_OPTIMIZATION")

	// ACSCSEmailNotifier enables support for the ACSCS email notifier integratioon
	ACSCSEmailNotifier = registerFeature(enabled, "Enable support for ACSCS Email notifier type", "ROX_ACSCS_EMAIL_NOTIFIER")

	// AttemptManifestDigest enables attempting to pull manifest digests from registres that historically did not
	// support it but now appear to (ie: Nexus and RHEL).
	AttemptManifestDigest = registerFeature(enabled, "Enables attempts to pull manifest digests for all registry integrations", "ROX_ATTEMPT_MANIFEST_DIGEST")

	// VulnMgmt2GA enables support for migration changes for VM 2.0 GA
	VulnMgmt2GA = registerFeature(enabled, "Enables support for migration changes for VM 2.0 GA", "ROX_VULN_MGMT_2_GA")

	// VulnMgmtAdvancedFilters enables support for advanced filters for VM 2.0 GA
	VulnMgmtAdvancedFilters = registerFeature(enabled, "Enables support for advanced filters for VM 2.0 GA", "ROX_VULN_MGMT_ADVANCED_FILTERS")

	// DelegateWatchedImageReprocessing when set to enabled reprocessing of watched images may be delegated to secured clusters based
	// on the delegated scanning config.
	DelegateWatchedImageReprocessing = registerFeature(enabled, "Enables delegating scans for watched images during reprocessing", "ROX_DELEGATE_WATCHED_IMAGE_REPROCESSING")

	// CollectorRuntimeConfig enables filtering of runtime events.
	CollectorRuntimeConfig = registerFeature(disabled, "Enable collector runtime configuration", "ROX_COLLECTOR_RUNTIME_CONFIG")

	// SensorSingleScanPerImage when set to enabled forces Sensor to allow only a single scan per image to be active at any given
	// time. Will only have an affect if UnqualifiedSearchRegistries is also enabled.
	// TODO(ROX-24641): Remove dependency on the UnqualifiedSearchRegistries feature so that this is enabled by default.
	SensorSingleScanPerImage = registerFeature(enabled, "Sensor will only allow a single active scan per image", "ROX_SENSOR_SINGLE_SCAN")
)
