values:
  ca:
    cert: ""
    key: ""
  scanner:
    serviceTLS:
      cert: ""
      key: ""
    dbServiceTLS:
      cert: ""
      key: ""
tests:
- name: "scanner with default settings"
  expect: |
    .secrets["scanner-tls"].stringData | assertThat(.["cert.pem"] | contains("BEGIN CERTIFICATE"))
    .secrets["scanner-tls"].stringData | assertThat(.["key.pem"] | contains("BEGIN RSA PRIVATE KEY"))
    .secrets["scanner-db-tls"].stringData | assertThat(.["cert.pem"] | contains("BEGIN CERTIFICATE"))
    .configmaps["scanner-config"].data.["config.yaml"] | assertThat(length != 0)
