load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")

go_library(
    name = "resolvers",
    srcs = [
        "access_scopes.go",
        "active_state.go",
        "activestateenum_string.go",
        "cluster_count_by_type.go",
        "cluster_health.go",
        "cluster_vulnerabilities.go",
        "clusters.go",
        "common_vulnerabilities.go",
        "compliance.go",
        "compliance_management.go",
        "compliance_utils.go",
        "components.go",
        "components_v1.go",
        "container_instances.go",
        "deploymentevents.go",
        "deployments.go",
        "generated.go",
        "groups.go",
        "image_components.go",
        "image_components_utilities.go",
        "image_cve_core.go",
        "image_scan.go",
        "image_vulnerabilities.go",
        "image_vulnerabilities_utilities.go",
        "images.go",
        "images_v2.go",
        "k8sroles.go",
        "labels.go",
        "namespaces.go",
        "node_components.go",
        "node_components_v1.go",
        "node_cve_core.go",
        "node_scan.go",
        "node_vulnerabilities.go",
        "nodes.go",
        "notifiers.go",
        "permission_sets.go",
        "platform_cve_core.go",
        "platform_cve_count_by_fixability.go",
        "platform_cve_count_by_type.go",
        "plotted_image_vulnerabilities.go",
        "plotted_node_vulnerabilities.go",
        "pods.go",
        "policies.go",
        "policy_counter.go",
        "policy_status.go",
        "resolver.go",
        "resource_count_by_severity.go",
        "risks.go",
        "roles.go",
        "schema.go",
        "search.go",
        "secrets.go",
        "service_accounts.go",
        "subjects.go",
        "test_setup_utils.go",
        "test_utils.go",
        "tokens.go",
        "utils.go",
        "violations.go",
        "vul_mgmt_widgets.go",
        "vulnerabilities.go",
        "vulnerabilities_v1.go",
        "vulnerability_counter.go",
        "vulnerability_requests.go",
        "vulnerability_vectors.go",
    ],
    importpath = "github.com/stackrox/rox/central/graphql/resolvers",
    visibility = ["//visibility:public"],
    deps = [
        "//central/activecomponent/converter",
        "//central/activecomponent/datastore",
        "//central/alert/datastore",
        "//central/apitoken/backend",
        "//central/audit",
        "//central/cluster/datastore",
        "//central/cluster/store/cluster/postgres",
        "//central/cluster/store/clusterhealth/postgres",
        "//central/clustercveedge/datastore",
        "//central/clustercveedge/datastore/store/postgres",
        "//central/compliance/aggregation",
        "//central/compliance/datastore",
        "//central/compliance/manager",
        "//central/compliance/manager/service",
        "//central/compliance/service",
        "//central/compliance/standards",
        "//central/complianceoperator/manager",
        "//central/componentcveedge/datastore",
        "//central/componentcveedge/datastore/store/postgres",
        "//central/cve/cluster/datastore",
        "//central/cve/cluster/datastore/store/postgres",
        "//central/cve/converter/utils",
        "//central/cve/converter/v2:converter",
        "//central/cve/fetcher",
        "//central/cve/image/datastore",
        "//central/cve/image/datastore/store/postgres",
        "//central/cve/image/v2/datastore",
        "//central/cve/image/v2/datastore/store/postgres",
        "//central/cve/matcher",
        "//central/cve/node/datastore",
        "//central/cve/node/datastore/store/postgres",
        "//central/deployment/datastore",
        "//central/graphql/generator",
        "//central/graphql/resolvers/common",
        "//central/graphql/resolvers/deploymentctx",
        "//central/graphql/resolvers/embeddedobjs",
        "//central/graphql/resolvers/inputtypes",
        "//central/graphql/resolvers/loaders",
        "//central/graphql/resolvers/searchers",
        "//central/group/datastore",
        "//central/image/datastore",
        "//central/image/datastore/store/common/v2:common",
        "//central/image/datastore/store/postgres",
        "//central/image/datastore/store/v2/postgres",
        "//central/image/mappings",
        "//central/imagecomponent/datastore",
        "//central/imagecomponent/datastore/store/postgres",
        "//central/imagecomponent/v2/datastore",
        "//central/imagecomponent/v2/datastore/store/postgres",
        "//central/imagecomponentedge/datastore",
        "//central/imagecveedge/datastore",
        "//central/imagecveedge/datastore/postgres",
        "//central/imagev2/datastore",
        "//central/imagev2/datastore/mapper/datastore",
        "//central/metrics",
        "//central/namespace",
        "//central/namespace/datastore",
        "//central/networkgraph/entity/datastore/mocks",
        "//central/networkgraph/flow/datastore",
        "//central/networkgraph/flow/datastore/mocks",
        "//central/networkpolicies/datastore",
        "//central/node/datastore",
        "//central/node/datastore/store/common/v2:common",
        "//central/node/datastore/store/postgres",
        "//central/node/mappings",
        "//central/nodecomponent/datastore",
        "//central/nodecomponent/datastore/store/postgres",
        "//central/nodecomponentcveedge/datastore",
        "//central/nodecomponentcveedge/datastore/store/postgres",
        "//central/notifier/datastore",
        "//central/notifier/processor",
        "//central/pod/datastore",
        "//central/policy/datastore",
        "//central/policy/matcher",
        "//central/policycategory/datastore",
        "//central/processbaseline",
        "//central/processbaseline/datastore",
        "//central/processindicator/datastore",
        "//central/processindicator/service",
        "//central/ranking",
        "//central/rbac/k8srole/datastore",
        "//central/rbac/k8srolebinding/datastore",
        "//central/rbac/service",
        "//central/rbac/utils",
        "//central/risk/datastore",
        "//central/risk/datastore/mocks",
        "//central/role/datastore",
        "//central/role/sachelper",
        "//central/role/service",
        "//central/search/service",
        "//central/secret/datastore",
        "//central/sensor/service/connection/mocks",
        "//central/serviceaccount/datastore",
        "//central/views",
        "//central/views/common",
        "//central/views/deployments",
        "//central/views/imagecomponentflat",
        "//central/views/imagecve",
        "//central/views/imagecveflat",
        "//central/views/images",
        "//central/views/nodecve",
        "//central/views/platformcve",
        "//central/vulnmgmt/vulnerabilityrequest/cache",
        "//central/vulnmgmt/vulnerabilityrequest/common",
        "//central/vulnmgmt/vulnerabilityrequest/datastore",
        "//central/vulnmgmt/vulnerabilityrequest/manager/querymgr",
        "//central/vulnmgmt/vulnerabilityrequest/manager/requestmgr",
        "//central/vulnmgmt/vulnerabilityrequest/utils",
        "//central/watchedimage/datastore",
        "//generated/api/v1:api",
        "//generated/storage",
        "//pkg/audit",
        "//pkg/auth/permissions",
        "//pkg/concurrency",
        "//pkg/containerid",
        "//pkg/cve",
        "//pkg/errox",
        "//pkg/features",
        "//pkg/fixtures",
        "//pkg/fixtures/fixtureconsts",
        "//pkg/grpc/authn",
        "//pkg/grpc/authn/mocks",
        "//pkg/grpc/authz",
        "//pkg/grpc/authz/interceptor",
        "//pkg/grpc/authz/or",
        "//pkg/grpc/authz/user",
        "//pkg/images/types",
        "//pkg/k8srbac",
        "//pkg/logging",
        "//pkg/metrics",
        "//pkg/mitre/datastore",
        "//pkg/mitre/utils",
        "//pkg/nodes/converter",
        "//pkg/pods/utils",
        "//pkg/pointers",
        "//pkg/policyutils",
        "//pkg/postgres/pgtest",
        "//pkg/processbaseline",
        "//pkg/protocompat",
        "//pkg/sac",
        "//pkg/sac/resources",
        "//pkg/scancomponent",
        "//pkg/search",
        "//pkg/search/paginated",
        "//pkg/search/postgres",
        "//pkg/search/predicate",
        "//pkg/search/scoped",
        "//pkg/set",
        "//pkg/sync",
        "//pkg/utils",
        "//pkg/uuid",
        "@com_github_facebookincubator_nvdtools//cvefeed/nvd/schema",
        "@com_github_graph_gophers_graphql_go//:graphql-go",
        "@com_github_pkg_errors//:errors",
        "@com_github_stretchr_testify//assert",
        "@com_github_stretchr_testify//require",
        "@org_golang_google_grpc//codes",
        "@org_golang_google_grpc//status",
        "@org_uber_go_mock//gomock",
    ],
)

alias(
    name = "go_default_library",
    actual = ":resolvers",
    visibility = ["//visibility:public"],
)

go_test(
    name = "resolvers_test",
    srcs = [
        "clusters_test.go",
        "compliance_test.go",
        "image_cve_core_test.go",
        "image_cve_v2_core_test.go",
        "image_scan_benchmark_test.go",
        "image_scan_test.go",
        "mutation_test.go",
        "node_cve_core_test.go",
        "node_scan_benchmark_test.go",
        "node_scan_test.go",
        "platform_cve_core_test.go",
        "policy_counter_test.go",
        "service_accounts_test.go",
        "utils_test.go",
        "vul_mgmt_widgets_test.go",
        "vulnerabilities_v1_test.go",
        "vulnerability_counter_test.go",
    ],
    embed = [":resolvers"],
    deps = [
        "//central/audit",
        "//central/cluster/datastore/mocks",
        "//central/cve/converter/utils",
        "//central/cve/image/datastore/mocks",
        "//central/cve/matcher",
        "//central/cve/node/datastore/mocks",
        "//central/deployment/datastore/mocks",
        "//central/graphql/resolvers/inputtypes",
        "//central/image/datastore/mocks",
        "//central/imagecomponent/datastore/mocks",
        "//central/imagecomponent/v2/datastore/mocks",
        "//central/namespace/datastore/mocks",
        "//central/networkpolicies/datastore/mocks",
        "//central/node/datastore/mocks",
        "//central/nodecomponent/datastore/mocks",
        "//central/secret/datastore/mocks",
        "//central/serviceaccount/datastore/mocks",
        "//central/views",
        "//central/views/imagecomponentflat",
        "//central/views/imagecomponentflat/mocks",
        "//central/views/imagecve",
        "//central/views/imagecve/mocks",
        "//central/views/imagecveflat",
        "//central/views/images",
        "//central/views/images/mocks",
        "//central/views/nodecve",
        "//central/views/nodecve/mocks",
        "//central/views/platformcve",
        "//central/views/platformcve/mocks",
        "//generated/api/v1:api",
        "//generated/storage",
        "//pkg/auth/permissions",
        "//pkg/errox",
        "//pkg/features",
        "//pkg/fixtures",
        "//pkg/fixtures/fixtureconsts",
        "//pkg/grpc/authn",
        "//pkg/grpc/authn/mocks",
        "//pkg/nodes/converter",
        "//pkg/notifier/mocks",
        "//pkg/pointers",
        "//pkg/protoassert",
        "//pkg/sac",
        "//pkg/sac/resources",
        "//pkg/search",
        "//pkg/search/postgres/aggregatefunc",
        "//pkg/set",
        "//pkg/uuid",
        "@com_github_facebookincubator_nvdtools//cvefeed/nvd/schema",
        "@com_github_graph_gophers_graphql_go//:graphql-go",
        "@com_github_stretchr_testify//assert",
        "@com_github_stretchr_testify//require",
        "@com_github_stretchr_testify//suite",
        "@org_uber_go_mock//gomock",
    ],
)
