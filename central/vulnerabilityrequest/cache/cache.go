package cache

import "github.com/stackrox/rox/generated/storage"

//go:generate mockgen-wrapper
// VulnReqCache provides functionality to cache vulnerability requests.
type VulnReqCache interface {
	Add(request *storage.VulnerabilityRequest) bool
	AddMany(requests ...*storage.VulnerabilityRequest)
	Remove(requestID string) bool
	GetVulnsWithState(registry, remote, tag string) map[string]storage.VulnerabilityState
	// GetEffectiveVulnState returns the effective state of the vulnerabilities within the given requests.
	GetEffectiveVulnState(cves []string, requestIDs ...string) map[string]storage.VulnerabilityState
	// GetEffectiveVulnReqID returns the vuln request in effect on given image+cve combination.
	GetEffectiveVulnReqID(registry, remote, tag, cve string) string
}
