package imageintegration

import "github.com/stackrox/rox/generated/storage"

// ValidForSync returns true if the provided image integration is eligible
// for syncing with secured clusters
func ValidForSync(ii *storage.ImageIntegration) bool {
	if ii.GetAutogenerated() {
		return false
	}

	var isReg bool
	for _, cat := range ii.GetCategories() {
		if cat == storage.ImageIntegrationCategory_REGISTRY {
			isReg = true
		}
	}

	return isReg
}
