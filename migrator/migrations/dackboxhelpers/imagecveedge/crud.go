// Code generated by cp generator. DO NOT EDIT.
// This file was originally generated with
// //go:generate cp ../../../central/imagecveedge/dackbox/crud.go imagecveedge/crud.go
package dackbox

import (
	"github.com/stackrox/rox/generated/storage"
	"github.com/stackrox/rox/pkg/dackbox/crud"
	"github.com/stackrox/rox/pkg/dbhelper"
	"github.com/stackrox/rox/pkg/protocompat"
)

var (
	// Bucket stores the image to cve edges.
	Bucket = []byte("image_to_cve")

	// BucketHandler is the bucket's handler.
	BucketHandler = &dbhelper.BucketHandler{BucketPrefix: Bucket}

	// Reader reads storage.ImageCVEEdges directly from the store.
	Reader = crud.NewReader(
		crud.WithAllocFunction(alloc),
	)

	// Upserter writes storage.ImageCVEEdges directly to the store.
	Upserter = crud.NewUpserter(
		crud.WithKeyFunction(crud.PrefixKey(Bucket, keyFunc)),
		crud.AddToIndex(),
	)

	// Deleter deletes the edges from the store.
	Deleter = crud.NewDeleter(
		crud.Shared(),
		crud.RemoveFromIndex(),
	)
)

func keyFunc(msg protocompat.Message) []byte {
	return []byte(msg.(*storage.ImageCVEEdge).GetId())
}

func alloc() protocompat.Message {
	return &storage.ImageCVEEdge{}
}
