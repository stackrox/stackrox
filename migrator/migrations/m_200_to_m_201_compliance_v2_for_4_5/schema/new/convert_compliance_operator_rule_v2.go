// Code generated by pg-bindings generator. DO NOT EDIT.
package new

import (
	"github.com/stackrox/rox/generated/storage"
)

// ConvertComplianceOperatorRuleV2FromProto converts a `*storage.ComplianceOperatorRuleV2` to Gorm model
func ConvertComplianceOperatorRuleV2FromProto(obj *storage.ComplianceOperatorRuleV2) (*ComplianceOperatorRuleV2, error) {
	serialized, err := obj.MarshalVT()
	if err != nil {
		return nil, err
	}
	model := &ComplianceOperatorRuleV2{
		ID:         obj.GetId(),
		Name:       obj.GetName(),
		RuleType:   obj.GetRuleType(),
		Severity:   obj.GetSeverity(),
		ClusterID:  obj.GetClusterId(),
		RuleRefID:  obj.GetRuleRefId(),
		Serialized: serialized,
	}
	return model, nil
}

// ConvertRuleControlsFromProto converts a `*storage.RuleControls` to Gorm model
func ConvertRuleControlsFromProto(obj *storage.RuleControls, idx int, complianceOperatorRuleV2ID string) (*ComplianceOperatorRuleV2Controls, error) {
	model := &ComplianceOperatorRuleV2Controls{
		ComplianceOperatorRuleV2ID: complianceOperatorRuleV2ID,
		Idx:                        idx,
		Standard:                   obj.GetStandard(),
		Control:                    obj.GetControl(),
	}
	return model, nil
}

// ConvertComplianceOperatorRuleV2ToProto converts Gorm model `ComplianceOperatorRuleV2` to its protobuf type object
func ConvertComplianceOperatorRuleV2ToProto(m *ComplianceOperatorRuleV2) (*storage.ComplianceOperatorRuleV2, error) {
	var msg storage.ComplianceOperatorRuleV2
	if err := msg.UnmarshalVTUnsafe(m.Serialized); err != nil {
		return nil, err
	}
	return &msg, nil
}
