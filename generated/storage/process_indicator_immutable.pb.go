// Code generated by protoc-gen-go-immutable. DO NOT EDIT.

package storage

import (
	"iter"
	"time"
)

// ImmutableProcessIndicator is an immutable interface for ProcessIndicator
type ImmutableProcessIndicator interface {
	// A unique UUID for the Indicator message
	GetId() string
	GetDeploymentId() string
	GetContainerName() string
	// Pod name
	GetPodId() string
	GetPodUid() string
	// A process signal message passed from Collector to Sensor
	GetImmutableSignal() ImmutableProcessSignal
	GetClusterId() string
	GetNamespace() string
	GetImmutableContainerStartTime() time.Time
	GetImageId() string
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *ProcessIndicator
}

// GetImmutableSignal implements ImmutableProcessIndicator
func (m *ProcessIndicator) GetImmutableSignal() ImmutableProcessSignal {
	return m.GetSignal()
}

// GetImmutableContainerStartTime implements ImmutableProcessIndicator
func (m *ProcessIndicator) GetImmutableContainerStartTime() time.Time {
	if m == nil || m.ContainerStartTime == nil {
		return time.Time{}
	}
	return m.ContainerStartTime.AsTime()
}

// Verify that ProcessIndicator implements ImmutableProcessIndicator
var _ ImmutableProcessIndicator = (*ProcessIndicator)(nil)

// ImmutableProcessIndicatorUniqueKey is an immutable interface for ProcessIndicatorUniqueKey
type ImmutableProcessIndicatorUniqueKey interface {
	GetPodId() string
	GetContainerName() string
	GetProcessName() string
	GetProcessExecFilePath() string
	GetProcessArgs() string
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *ProcessIndicatorUniqueKey
}

// Verify that ProcessIndicatorUniqueKey implements ImmutableProcessIndicatorUniqueKey
var _ ImmutableProcessIndicatorUniqueKey = (*ProcessIndicatorUniqueKey)(nil)

// ImmutableNetworkProcessUniqueKey is an immutable interface for NetworkProcessUniqueKey
type ImmutableNetworkProcessUniqueKey interface {
	GetProcessName() string
	GetProcessExecFilePath() string
	GetProcessArgs() string
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *NetworkProcessUniqueKey
}

// Verify that NetworkProcessUniqueKey implements ImmutableNetworkProcessUniqueKey
var _ ImmutableNetworkProcessUniqueKey = (*NetworkProcessUniqueKey)(nil)

// ImmutableProcessSignal is an immutable interface for ProcessSignal
type ImmutableProcessSignal interface {
	// A unique UUID for identifying the message
	// We have this here instead of at the top level
	// because we want to have each message to be
	// self contained.
	GetId() string
	// ID of container associated with this process
	GetContainerId() string
	// Process creation time
	GetImmutableTime() time.Time
	// Process name
	GetName() string
	// Process arguments
	GetArgs() string
	// Process executable file path
	GetExecFilePath() string
	// Host process ID
	GetPid() uint32
	// Real user ID
	GetUid() uint32
	// Real group ID
	GetGid() uint32
	// Process Lineage
	GetImmutableLineage() iter.Seq[string]
	// Signal origin
	GetScraped() bool
	// Process LineageInfo
	GetImmutableLineageInfo() iter.Seq[ImmutableProcessSignal_LineageInfo]
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *ProcessSignal
}

// GetImmutableTime implements ImmutableProcessSignal
func (m *ProcessSignal) GetImmutableTime() time.Time {
	if m == nil || m.Time == nil {
		return time.Time{}
	}
	return m.Time.AsTime()
}

// GetImmutableLineage implements ImmutableProcessSignal
func (m *ProcessSignal) GetImmutableLineage() iter.Seq[string] {
	return func(yield func(string) bool) {
		if m == nil || m.Lineage == nil {
			return
		}
		for _, v := range m.Lineage {
			if !yield(v) {
				return
			}
		}
	}
}

// GetImmutableLineageInfo implements ImmutableProcessSignal
func (m *ProcessSignal) GetImmutableLineageInfo() iter.Seq[ImmutableProcessSignal_LineageInfo] {
	return func(yield func(ImmutableProcessSignal_LineageInfo) bool) {
		if m == nil || m.LineageInfo == nil {
			return
		}
		for _, v := range m.LineageInfo {
			if !yield(v) {
				return
			}
		}
	}
}

// Verify that ProcessSignal implements ImmutableProcessSignal
var _ ImmutableProcessSignal = (*ProcessSignal)(nil)

// ImmutableProcessSignal_LineageInfo is an immutable interface for ProcessSignal_LineageInfo
type ImmutableProcessSignal_LineageInfo interface {
	GetParentUid() uint32
	GetParentExecFilePath() string
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *ProcessSignal_LineageInfo
}

// Verify that ProcessSignal_LineageInfo implements ImmutableProcessSignal_LineageInfo
var _ ImmutableProcessSignal_LineageInfo = (*ProcessSignal_LineageInfo)(nil)
