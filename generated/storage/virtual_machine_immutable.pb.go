// Code generated by protoc-gen-go-immutable. DO NOT EDIT.

package storage

import (
	"iter"
	"time"
)

// ImmutableVirtualMachine is an immutable interface for VirtualMachine
type ImmutableVirtualMachine interface {
	GetId() string
	GetNamespace() string
	GetName() string
	GetClusterId() string
	GetClusterName() string
	GetImmutableFacts() iter.Seq2[string, string]
	GetImmutableLastUpdated() time.Time
	GetImmutableNotes() iter.Seq[VirtualMachine_Note]
	GetVsockCid() int32
	GetState() VirtualMachine_State
	GetImmutableScan() ImmutableVirtualMachineScan
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *VirtualMachine
}

// GetImmutableFacts implements ImmutableVirtualMachine
func (m *VirtualMachine) GetImmutableFacts() iter.Seq2[string, string] {
	return func(yield func(string, string) bool) {
		if m == nil || m.Facts == nil {
			return
		}
		for k, v := range m.Facts {
			if !yield(k, v) {
				return
			}
		}
	}
}

// GetImmutableLastUpdated implements ImmutableVirtualMachine
func (m *VirtualMachine) GetImmutableLastUpdated() time.Time {
	if m == nil || m.LastUpdated == nil {
		return time.Time{}
	}
	return m.LastUpdated.AsTime()
}

// GetImmutableNotes implements ImmutableVirtualMachine
func (m *VirtualMachine) GetImmutableNotes() iter.Seq[VirtualMachine_Note] {
	return func(yield func(VirtualMachine_Note) bool) {
		if m == nil || m.Notes == nil {
			return
		}
		for _, v := range m.Notes {
			if !yield(v) {
				return
			}
		}
	}
}

// GetImmutableScan implements ImmutableVirtualMachine
func (m *VirtualMachine) GetImmutableScan() ImmutableVirtualMachineScan {
	return m.GetScan()
}

// Verify that VirtualMachine implements ImmutableVirtualMachine
var _ ImmutableVirtualMachine = (*VirtualMachine)(nil)

// ImmutableVirtualMachineScan is an immutable interface for VirtualMachineScan
type ImmutableVirtualMachineScan interface {
	GetImmutableScanTime() time.Time
	GetOperatingSystem() string
	GetImmutableNotes() iter.Seq[VirtualMachineScan_Note]
	GetImmutableComponents() iter.Seq[ImmutableEmbeddedVirtualMachineScanComponent]
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *VirtualMachineScan
}

// GetImmutableScanTime implements ImmutableVirtualMachineScan
func (m *VirtualMachineScan) GetImmutableScanTime() time.Time {
	if m == nil || m.ScanTime == nil {
		return time.Time{}
	}
	return m.ScanTime.AsTime()
}

// GetImmutableNotes implements ImmutableVirtualMachineScan
func (m *VirtualMachineScan) GetImmutableNotes() iter.Seq[VirtualMachineScan_Note] {
	return func(yield func(VirtualMachineScan_Note) bool) {
		if m == nil || m.Notes == nil {
			return
		}
		for _, v := range m.Notes {
			if !yield(v) {
				return
			}
		}
	}
}

// GetImmutableComponents implements ImmutableVirtualMachineScan
func (m *VirtualMachineScan) GetImmutableComponents() iter.Seq[ImmutableEmbeddedVirtualMachineScanComponent] {
	return func(yield func(ImmutableEmbeddedVirtualMachineScanComponent) bool) {
		if m == nil || m.Components == nil {
			return
		}
		for _, v := range m.Components {
			if !yield(v) {
				return
			}
		}
	}
}

// Verify that VirtualMachineScan implements ImmutableVirtualMachineScan
var _ ImmutableVirtualMachineScan = (*VirtualMachineScan)(nil)

// ImmutableEmbeddedVirtualMachineScanComponent is an immutable interface for EmbeddedVirtualMachineScanComponent
type ImmutableEmbeddedVirtualMachineScanComponent interface {
	GetName() string
	GetVersion() string
	GetTopCvss() float32
	GetRiskScore() float32
	GetImmutableVulnerabilities() iter.Seq[ImmutableVirtualMachineVulnerability]
	GetSource() SourceType
	GetImmutableNotes() iter.Seq[EmbeddedVirtualMachineScanComponent_Note]
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *EmbeddedVirtualMachineScanComponent
}

// GetImmutableVulnerabilities implements ImmutableEmbeddedVirtualMachineScanComponent
func (m *EmbeddedVirtualMachineScanComponent) GetImmutableVulnerabilities() iter.Seq[ImmutableVirtualMachineVulnerability] {
	return func(yield func(ImmutableVirtualMachineVulnerability) bool) {
		if m == nil || m.Vulnerabilities == nil {
			return
		}
		for _, v := range m.Vulnerabilities {
			if !yield(v) {
				return
			}
		}
	}
}

// GetImmutableNotes implements ImmutableEmbeddedVirtualMachineScanComponent
func (m *EmbeddedVirtualMachineScanComponent) GetImmutableNotes() iter.Seq[EmbeddedVirtualMachineScanComponent_Note] {
	return func(yield func(EmbeddedVirtualMachineScanComponent_Note) bool) {
		if m == nil || m.Notes == nil {
			return
		}
		for _, v := range m.Notes {
			if !yield(v) {
				return
			}
		}
	}
}

// Verify that EmbeddedVirtualMachineScanComponent implements ImmutableEmbeddedVirtualMachineScanComponent
var _ ImmutableEmbeddedVirtualMachineScanComponent = (*EmbeddedVirtualMachineScanComponent)(nil)

// ImmutableVirtualMachineVulnerability is an immutable interface for VirtualMachineVulnerability
type ImmutableVirtualMachineVulnerability interface {
	GetImmutableCveBaseInfo() ImmutableVirtualMachineCVEInfo
	GetSeverity() VulnerabilitySeverity
	GetFixedBy() string
	GetCvss() float32
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *VirtualMachineVulnerability
}

// GetImmutableCveBaseInfo implements ImmutableVirtualMachineVulnerability
func (m *VirtualMachineVulnerability) GetImmutableCveBaseInfo() ImmutableVirtualMachineCVEInfo {
	return m.GetCveBaseInfo()
}

// Verify that VirtualMachineVulnerability implements ImmutableVirtualMachineVulnerability
var _ ImmutableVirtualMachineVulnerability = (*VirtualMachineVulnerability)(nil)

// ImmutableVirtualMachineCVEInfo is an immutable interface for VirtualMachineCVEInfo
type ImmutableVirtualMachineCVEInfo interface {
	GetCve() string
	GetSummary() string
	GetLink() string
	// This indicates the timestamp when the cve was first published in the cve feeds.
	GetImmutablePublishedOn() time.Time
	// Time when the CVE was first seen in the system.
	GetImmutableCreatedAt() time.Time
	GetImmutableLastModified() time.Time
	GetImmutableReferences() iter.Seq[ImmutableVirtualMachineCVEInfo_Reference]
	// cvss_metrics stores list of cvss scores from different sources like nvd, Redhat etc
	GetImmutableCvssMetrics() iter.Seq[ImmutableCVSSScore]
	GetImmutableEpss() ImmutableVirtualMachineEPSS
	GetImmutableAdvisory() ImmutableVirtualMachineAdvisory
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *VirtualMachineCVEInfo
}

// GetImmutablePublishedOn implements ImmutableVirtualMachineCVEInfo
func (m *VirtualMachineCVEInfo) GetImmutablePublishedOn() time.Time {
	if m == nil || m.PublishedOn == nil {
		return time.Time{}
	}
	return m.PublishedOn.AsTime()
}

// GetImmutableCreatedAt implements ImmutableVirtualMachineCVEInfo
func (m *VirtualMachineCVEInfo) GetImmutableCreatedAt() time.Time {
	if m == nil || m.CreatedAt == nil {
		return time.Time{}
	}
	return m.CreatedAt.AsTime()
}

// GetImmutableLastModified implements ImmutableVirtualMachineCVEInfo
func (m *VirtualMachineCVEInfo) GetImmutableLastModified() time.Time {
	if m == nil || m.LastModified == nil {
		return time.Time{}
	}
	return m.LastModified.AsTime()
}

// GetImmutableReferences implements ImmutableVirtualMachineCVEInfo
func (m *VirtualMachineCVEInfo) GetImmutableReferences() iter.Seq[ImmutableVirtualMachineCVEInfo_Reference] {
	return func(yield func(ImmutableVirtualMachineCVEInfo_Reference) bool) {
		if m == nil || m.References == nil {
			return
		}
		for _, v := range m.References {
			if !yield(v) {
				return
			}
		}
	}
}

// GetImmutableCvssMetrics implements ImmutableVirtualMachineCVEInfo
func (m *VirtualMachineCVEInfo) GetImmutableCvssMetrics() iter.Seq[ImmutableCVSSScore] {
	return func(yield func(ImmutableCVSSScore) bool) {
		if m == nil || m.CvssMetrics == nil {
			return
		}
		for _, v := range m.CvssMetrics {
			if !yield(v) {
				return
			}
		}
	}
}

// GetImmutableEpss implements ImmutableVirtualMachineCVEInfo
func (m *VirtualMachineCVEInfo) GetImmutableEpss() ImmutableVirtualMachineEPSS {
	return m.GetEpss()
}

// GetImmutableAdvisory implements ImmutableVirtualMachineCVEInfo
func (m *VirtualMachineCVEInfo) GetImmutableAdvisory() ImmutableVirtualMachineAdvisory {
	return m.GetAdvisory()
}

// Verify that VirtualMachineCVEInfo implements ImmutableVirtualMachineCVEInfo
var _ ImmutableVirtualMachineCVEInfo = (*VirtualMachineCVEInfo)(nil)

// ImmutableVirtualMachineCVEInfo_Reference is an immutable interface for VirtualMachineCVEInfo_Reference
type ImmutableVirtualMachineCVEInfo_Reference interface {
	GetURI() string
	GetImmutableTags() iter.Seq[string]
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *VirtualMachineCVEInfo_Reference
}

// GetImmutableTags implements ImmutableVirtualMachineCVEInfo_Reference
func (m *VirtualMachineCVEInfo_Reference) GetImmutableTags() iter.Seq[string] {
	return func(yield func(string) bool) {
		if m == nil || m.Tags == nil {
			return
		}
		for _, v := range m.Tags {
			if !yield(v) {
				return
			}
		}
	}
}

// Verify that VirtualMachineCVEInfo_Reference implements ImmutableVirtualMachineCVEInfo_Reference
var _ ImmutableVirtualMachineCVEInfo_Reference = (*VirtualMachineCVEInfo_Reference)(nil)

// ImmutableVirtualMachineEPSS is an immutable interface for VirtualMachineEPSS
type ImmutableVirtualMachineEPSS interface {
	GetEpssProbability() float32
	GetEpssPercentile() float32
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *VirtualMachineEPSS
}

// Verify that VirtualMachineEPSS implements ImmutableVirtualMachineEPSS
var _ ImmutableVirtualMachineEPSS = (*VirtualMachineEPSS)(nil)

// ImmutableVirtualMachineAdvisory is an immutable interface for VirtualMachineAdvisory
type ImmutableVirtualMachineAdvisory interface {
	GetName() string
	GetLink() string
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *VirtualMachineAdvisory
}

// Verify that VirtualMachineAdvisory implements ImmutableVirtualMachineAdvisory
var _ ImmutableVirtualMachineAdvisory = (*VirtualMachineAdvisory)(nil)
