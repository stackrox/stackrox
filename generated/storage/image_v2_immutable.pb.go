// Code generated by protoc-gen-go-immutable. DO NOT EDIT.

package storage

import (
	"iter"
	"time"
)

// ImmutableImageV2 is an immutable interface for ImageV2
type ImmutableImageV2 interface {
	GetId() string
	GetDigest() string
	GetImmutableName() ImmutableImageName
	GetImmutableMetadata() ImmutableImageMetadata
	GetImmutableScan() ImmutableImageScan
	GetImmutableSignatureVerificationData() ImmutableImageSignatureVerificationData
	GetImmutableSignature() ImmutableImageSignature
	GetImmutableScanStats() ImmutableImageV2_ScanStats
	GetImmutableLastUpdated() time.Time
	GetNotPullable() bool
	GetIsClusterLocal() bool
	GetPriority() int64
	GetRiskScore() float32
	// Caching top cvss to avoid re-calculating it by joining on the cve table.
	GetTopCvss() float32
	GetImmutableNotes() iter.Seq[ImageV2_Note]
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *ImageV2
}

// GetImmutableName implements ImmutableImageV2
func (m *ImageV2) GetImmutableName() ImmutableImageName {
	return m.GetName()
}

// GetImmutableMetadata implements ImmutableImageV2
func (m *ImageV2) GetImmutableMetadata() ImmutableImageMetadata {
	return m.GetMetadata()
}

// GetImmutableScan implements ImmutableImageV2
func (m *ImageV2) GetImmutableScan() ImmutableImageScan {
	return m.GetScan()
}

// GetImmutableSignatureVerificationData implements ImmutableImageV2
func (m *ImageV2) GetImmutableSignatureVerificationData() ImmutableImageSignatureVerificationData {
	return m.GetSignatureVerificationData()
}

// GetImmutableSignature implements ImmutableImageV2
func (m *ImageV2) GetImmutableSignature() ImmutableImageSignature {
	return m.GetSignature()
}

// GetImmutableScanStats implements ImmutableImageV2
func (m *ImageV2) GetImmutableScanStats() ImmutableImageV2_ScanStats {
	return m.GetScanStats()
}

// GetImmutableLastUpdated implements ImmutableImageV2
func (m *ImageV2) GetImmutableLastUpdated() time.Time {
	if m == nil || m.LastUpdated == nil {
		return time.Time{}
	}
	return m.LastUpdated.AsTime()
}

// GetImmutableNotes implements ImmutableImageV2
func (m *ImageV2) GetImmutableNotes() iter.Seq[ImageV2_Note] {
	return func(yield func(ImageV2_Note) bool) {
		if m == nil || m.Notes == nil {
			return
		}
		for _, v := range m.Notes {
			if !yield(v) {
				return
			}
		}
	}
}

// Verify that ImageV2 implements ImmutableImageV2
var _ ImmutableImageV2 = (*ImageV2)(nil)

// ImmutableImageV2_ScanStats is an immutable interface for ImageV2_ScanStats
type ImmutableImageV2_ScanStats interface {
	// Caching component count to avoid re-calculating it by joining on the component table.
	GetComponentCount() int32
	// Caching cve count to avoid re-calculating it by joining on the cve table.
	GetCveCount() int32
	// Caching fixable cve count to avoid re-calculating it by joining on the cve table.
	GetFixableCveCount() int32
	// Caching unknown cve count to avoid re-calculating it by joining on the cve table.
	GetUnknownCveCount() int32
	// Caching fixable unknown cve count to avoid re-calculating it by joining on the cve table.
	GetFixableUnknownCveCount() int32
	// Caching critical cve count to avoid re-calculating it by joining on the cve table.
	GetCriticalCveCount() int32
	// Caching fixable critical cve count to avoid re-calculating it by joining on the cve table.
	GetFixableCriticalCveCount() int32
	// Caching important cve count to avoid re-calculating it by joining on the cve table.
	GetImportantCveCount() int32
	// Caching fixable important cve count to avoid re-calculating it by joining on the cve table.
	GetFixableImportantCveCount() int32
	// Caching moderate cve count to avoid re-calculating it by joining on the cve table.
	GetModerateCveCount() int32
	// Caching fixable moderate cve count to avoid re-calculating it by joining on the cve table.
	GetFixableModerateCveCount() int32
	// Caching low cve count to avoid re-calculating it by joining on the cve table.
	GetLowCveCount() int32
	// Caching fixable low cve count to avoid re-calculating it by joining on the cve table.
	GetFixableLowCveCount() int32
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *ImageV2_ScanStats
}

// Verify that ImageV2_ScanStats implements ImmutableImageV2_ScanStats
var _ ImmutableImageV2_ScanStats = (*ImageV2_ScanStats)(nil)

// ImmutableListImageV2 is an immutable interface for ListImageV2
type ImmutableListImageV2 interface {
	GetId() string
	GetName() string
	GetComponentCount() int32
	GetCveCount() int32
	GetFixableCveCount() int32
	GetImmutableCreated() time.Time
	GetImmutableLastUpdated() time.Time
	GetPriority() int64
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *ListImageV2
}

// GetImmutableCreated implements ImmutableListImageV2
func (m *ListImageV2) GetImmutableCreated() time.Time {
	if m == nil || m.Created == nil {
		return time.Time{}
	}
	return m.Created.AsTime()
}

// GetImmutableLastUpdated implements ImmutableListImageV2
func (m *ListImageV2) GetImmutableLastUpdated() time.Time {
	if m == nil || m.LastUpdated == nil {
		return time.Time{}
	}
	return m.LastUpdated.AsTime()
}

// Verify that ListImageV2 implements ImmutableListImageV2
var _ ImmutableListImageV2 = (*ListImageV2)(nil)
