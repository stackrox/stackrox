// Code generated by protoc-gen-go-immutable. DO NOT EDIT.

package storage

import (
	"iter"
	"time"
)

// ImmutableNetworkFlow is an immutable interface for NetworkFlow
type ImmutableNetworkFlow interface {
	GetImmutableProps() ImmutableNetworkFlowProperties
	GetImmutableLastSeenTimestamp() time.Time
	// Need the clusterID as that is part of the key in RocksDB
	GetClusterId() string
	// This field is set by Central everytime a flow is upserted.
	// This should not be set by Sensor.
	// For more context: https://github.com/stackrox/stackrox/pull/14483
	GetImmutableUpdatedAt() time.Time
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *NetworkFlow
}

// GetImmutableProps implements ImmutableNetworkFlow
func (m *NetworkFlow) GetImmutableProps() ImmutableNetworkFlowProperties {
	return m.GetProps()
}

// GetImmutableLastSeenTimestamp implements ImmutableNetworkFlow
func (m *NetworkFlow) GetImmutableLastSeenTimestamp() time.Time {
	if m == nil || m.LastSeenTimestamp == nil {
		return time.Time{}
	}
	return m.LastSeenTimestamp.AsTime()
}

// GetImmutableUpdatedAt implements ImmutableNetworkFlow
func (m *NetworkFlow) GetImmutableUpdatedAt() time.Time {
	if m == nil || m.UpdatedAt == nil {
		return time.Time{}
	}
	return m.UpdatedAt.AsTime()
}

// Verify that NetworkFlow implements ImmutableNetworkFlow
var _ ImmutableNetworkFlow = (*NetworkFlow)(nil)

// ImmutableNetworkFlowProperties is an immutable interface for NetworkFlowProperties
type ImmutableNetworkFlowProperties interface {
	// The source deployment ID of the network flow
	GetImmutableSrcEntity() ImmutableNetworkEntityInfo
	// The destination deployment ID of the network flow
	GetImmutableDstEntity() ImmutableNetworkEntityInfo
	// may be 0 if not applicable (e.g., icmp).
	GetDstPort() uint32
	GetL4Protocol() L4Protocol
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *NetworkFlowProperties
}

// GetImmutableSrcEntity implements ImmutableNetworkFlowProperties
func (m *NetworkFlowProperties) GetImmutableSrcEntity() ImmutableNetworkEntityInfo {
	return m.GetSrcEntity()
}

// GetImmutableDstEntity implements ImmutableNetworkFlowProperties
func (m *NetworkFlowProperties) GetImmutableDstEntity() ImmutableNetworkEntityInfo {
	return m.GetDstEntity()
}

// Verify that NetworkFlowProperties implements ImmutableNetworkFlowProperties
var _ ImmutableNetworkFlowProperties = (*NetworkFlowProperties)(nil)

// ImmutableNetworkEndpoint is an immutable interface for NetworkEndpoint
type ImmutableNetworkEndpoint interface {
	GetImmutableProps() ImmutableNetworkEndpointProperties
	GetImmutableLastActiveTimestamp() time.Time
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *NetworkEndpoint
}

// GetImmutableProps implements ImmutableNetworkEndpoint
func (m *NetworkEndpoint) GetImmutableProps() ImmutableNetworkEndpointProperties {
	return m.GetProps()
}

// GetImmutableLastActiveTimestamp implements ImmutableNetworkEndpoint
func (m *NetworkEndpoint) GetImmutableLastActiveTimestamp() time.Time {
	if m == nil || m.LastActiveTimestamp == nil {
		return time.Time{}
	}
	return m.LastActiveTimestamp.AsTime()
}

// Verify that NetworkEndpoint implements ImmutableNetworkEndpoint
var _ ImmutableNetworkEndpoint = (*NetworkEndpoint)(nil)

// ImmutableNetworkEndpointProperties is an immutable interface for NetworkEndpointProperties
type ImmutableNetworkEndpointProperties interface {
	GetImmutableEntity() ImmutableNetworkEntityInfo
	GetPort() uint32
	GetL4Protocol() L4Protocol
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *NetworkEndpointProperties
}

// GetImmutableEntity implements ImmutableNetworkEndpointProperties
func (m *NetworkEndpointProperties) GetImmutableEntity() ImmutableNetworkEntityInfo {
	return m.GetEntity()
}

// Verify that NetworkEndpointProperties implements ImmutableNetworkEndpointProperties
var _ ImmutableNetworkEndpointProperties = (*NetworkEndpointProperties)(nil)

// ImmutableNetworkEntity is an immutable interface for NetworkEntity
type ImmutableNetworkEntity interface {
	GetImmutableInfo() ImmutableNetworkEntityInfo
	// `scope` represents known cluster network peers to which the flows must be scoped. In future, to restrict flows
	// to more granular entities, such as deployment, scope could include deployment ID.
	// Note: The highest scope level is cluster.
	GetImmutableScope() ImmutableNetworkEntity_Scope
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *NetworkEntity
}

// GetImmutableInfo implements ImmutableNetworkEntity
func (m *NetworkEntity) GetImmutableInfo() ImmutableNetworkEntityInfo {
	return m.GetInfo()
}

// GetImmutableScope implements ImmutableNetworkEntity
func (m *NetworkEntity) GetImmutableScope() ImmutableNetworkEntity_Scope {
	return m.GetScope()
}

// Verify that NetworkEntity implements ImmutableNetworkEntity
var _ ImmutableNetworkEntity = (*NetworkEntity)(nil)

// ImmutableNetworkEntity_Scope is an immutable interface for NetworkEntity_Scope
type ImmutableNetworkEntity_Scope interface {
	GetClusterId() string
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *NetworkEntity_Scope
}

// Verify that NetworkEntity_Scope implements ImmutableNetworkEntity_Scope
var _ ImmutableNetworkEntity_Scope = (*NetworkEntity_Scope)(nil)

// ImmutableNetworkEntityInfo is an immutable interface for NetworkEntityInfo
type ImmutableNetworkEntityInfo interface {
	GetType() NetworkEntityInfo_Type
	GetId() string
	GetImmutableDeployment() ImmutableNetworkEntityInfo_Deployment
	GetImmutableExternalSource() ImmutableNetworkEntityInfo_ExternalSource
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *NetworkEntityInfo
}

// GetImmutableDeployment implements ImmutableNetworkEntityInfo
func (m *NetworkEntityInfo) GetImmutableDeployment() ImmutableNetworkEntityInfo_Deployment {
	return m.GetDeployment()
}

// GetImmutableExternalSource implements ImmutableNetworkEntityInfo
func (m *NetworkEntityInfo) GetImmutableExternalSource() ImmutableNetworkEntityInfo_ExternalSource {
	return m.GetExternalSource()
}

// Verify that NetworkEntityInfo implements ImmutableNetworkEntityInfo
var _ ImmutableNetworkEntityInfo = (*NetworkEntityInfo)(nil)

// ImmutableNetworkEntityInfo_Deployment is an immutable interface for NetworkEntityInfo_Deployment
type ImmutableNetworkEntityInfo_Deployment interface {
	GetName() string
	GetNamespace() string
	GetCluster() string
	GetImmutableListenPorts() iter.Seq[ImmutableNetworkEntityInfo_Deployment_ListenPort]
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *NetworkEntityInfo_Deployment
}

// GetImmutableListenPorts implements ImmutableNetworkEntityInfo_Deployment
func (m *NetworkEntityInfo_Deployment) GetImmutableListenPorts() iter.Seq[ImmutableNetworkEntityInfo_Deployment_ListenPort] {
	return func(yield func(ImmutableNetworkEntityInfo_Deployment_ListenPort) bool) {
		if m == nil || m.ListenPorts == nil {
			return
		}
		for _, v := range m.ListenPorts {
			if !yield(v) {
				return
			}
		}
	}
}

// Verify that NetworkEntityInfo_Deployment implements ImmutableNetworkEntityInfo_Deployment
var _ ImmutableNetworkEntityInfo_Deployment = (*NetworkEntityInfo_Deployment)(nil)

// ImmutableNetworkEntityInfo_Deployment_ListenPort is an immutable interface for NetworkEntityInfo_Deployment_ListenPort
type ImmutableNetworkEntityInfo_Deployment_ListenPort interface {
	GetPort() uint32
	GetL4Protocol() L4Protocol
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *NetworkEntityInfo_Deployment_ListenPort
}

// Verify that NetworkEntityInfo_Deployment_ListenPort implements ImmutableNetworkEntityInfo_Deployment_ListenPort
var _ ImmutableNetworkEntityInfo_Deployment_ListenPort = (*NetworkEntityInfo_Deployment_ListenPort)(nil)

// ImmutableNetworkEntityInfo_ExternalSource is an immutable interface for NetworkEntityInfo_ExternalSource
type ImmutableNetworkEntityInfo_ExternalSource interface {
	GetName() string
	GetCidr() string
	// `default` indicates whether the external source is user-generated or system-generated.
	GetDefault() bool
	// `discovered` indicates whether the external source is harvested from monitored traffic.
	GetDiscovered() bool
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *NetworkEntityInfo_ExternalSource
}

// Verify that NetworkEntityInfo_ExternalSource implements ImmutableNetworkEntityInfo_ExternalSource
var _ ImmutableNetworkEntityInfo_ExternalSource = (*NetworkEntityInfo_ExternalSource)(nil)
