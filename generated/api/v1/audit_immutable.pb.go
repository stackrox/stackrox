// Code generated by protoc-gen-go-immutable. DO NOT EDIT.

package v1

import (
	storage "github.com/stackrox/rox/generated/storage"
	anypb "google.golang.org/protobuf/types/known/anypb"
)

import (
	"time"
)

// ImmutableAudit is an immutable interface for Audit
type ImmutableAudit interface {
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *Audit
}

// Verify that Audit implements ImmutableAudit
var _ ImmutableAudit = (*Audit)(nil)

// ImmutableAudit_Message is an immutable interface for Audit_Message
type ImmutableAudit_Message interface {
	GetImmutableTime() time.Time
	GetStatus() Audit_RequestStatus
	GetStatusReason() string
	GetUser() *storage.UserInfo
	GetImmutableRequest() ImmutableAudit_Message_Request
	GetMethod() Audit_AccessMethod
	GetInteraction() Audit_Interaction
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *Audit_Message
}

// GetImmutableTime implements ImmutableAudit_Message
func (m *Audit_Message) GetImmutableTime() time.Time {
	if m == nil || m.Time == nil {
		return time.Time{}
	}
	return m.Time.AsTime()
}

// GetImmutableRequest implements ImmutableAudit_Message
func (m *Audit_Message) GetImmutableRequest() ImmutableAudit_Message_Request {
	return m.GetRequest()
}

// Verify that Audit_Message implements ImmutableAudit_Message
var _ ImmutableAudit_Message = (*Audit_Message)(nil)

// ImmutableAudit_Message_Request is an immutable interface for Audit_Message_Request
type ImmutableAudit_Message_Request interface {
	GetEndpoint() string
	GetMethod() string
	GetPayload() *anypb.Any
	GetImmutableSourceHeaders() ImmutableAudit_Message_Request_SourceHeaders
	// The source IP of the request.
	// This is determined from the values found within the request's source.
	// The following priority is given:
	// 1. X-Forwarded-For
	// 2. Remote-Addr
	// 3. Request address
	//
	// Depending on how Central configured to be exposed, the source IP _may_ be a cluster internal IP.
	//
	// In case of exposure with a Kubernetes Load Balancer Service, follow this configuration instruction
	// to preserve the client IP: https://kubernetes.io/docs/tasks/access-application-cluster/create-external-load-balancer/#preserving-the-client-source-ip
	//
	// In case of exposure with a Route, following types support preserving the client IP:
	// - edge
	// - re-encrypt
	// The tls-passthrough type does not support preserving the client IP, due to the router not being able
	// to decrypt the incoming HTTP request and adding additional headers (i.e. X-Forwarded-For) to the request.
	//
	// In case of exposure with a custom loadbalancer / ingress controller, if HTTPS is passed through to the
	// Central, it also might not preserve the client IP correctly.
	GetSourceIp() string
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *Audit_Message_Request
}

// GetImmutableSourceHeaders implements ImmutableAudit_Message_Request
func (m *Audit_Message_Request) GetImmutableSourceHeaders() ImmutableAudit_Message_Request_SourceHeaders {
	return m.GetSourceHeaders()
}

// Verify that Audit_Message_Request implements ImmutableAudit_Message_Request
var _ ImmutableAudit_Message_Request = (*Audit_Message_Request)(nil)

// ImmutableAudit_Message_Request_SourceHeaders is an immutable interface for Audit_Message_Request_SourceHeaders
type ImmutableAudit_Message_Request_SourceHeaders interface {
	// The "X-Forwarded-For" header associated with the request, if it was present.
	GetXForwardedFor() string
	// The "Remote-Addr" header associated with the request, if it was present.
	GetRemoteAddr() string
	// The HTTP request's address. This will always be present, but may not preserve
	// the _actual_ client IP. See source_ip for a more detailed documentation.
	GetRequestAddr() string
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *Audit_Message_Request_SourceHeaders
}

// Verify that Audit_Message_Request_SourceHeaders implements ImmutableAudit_Message_Request_SourceHeaders
var _ ImmutableAudit_Message_Request_SourceHeaders = (*Audit_Message_Request_SourceHeaders)(nil)
