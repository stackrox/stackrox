// Code generated by protoc-gen-go-immutable. DO NOT EDIT.

package v1

import (
	storage "github.com/stackrox/rox/generated/storage"
)

import (
	"iter"
	"time"
)

// ImmutableUserAttribute is an immutable interface for UserAttribute
type ImmutableUserAttribute interface {
	GetKey() string
	GetImmutableValues() iter.Seq[string]
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *UserAttribute
}

// GetImmutableValues implements ImmutableUserAttribute
func (m *UserAttribute) GetImmutableValues() iter.Seq[string] {
	return func(yield func(string) bool) {
		if m == nil || m.Values == nil {
			return
		}
		for _, v := range m.Values {
			if !yield(v) {
				return
			}
		}
	}
}

// Verify that UserAttribute implements ImmutableUserAttribute
var _ ImmutableUserAttribute = (*UserAttribute)(nil)

// ImmutableAuthStatus is an immutable interface for AuthStatus
type ImmutableAuthStatus interface {
	GetUserId() string
	GetServiceId() *storage.ServiceIdentity
	GetImmutableExpires() time.Time
	GetRefreshUrl() string
	GetAuthProvider() *storage.AuthProvider
	GetUserInfo() *storage.UserInfo
	GetImmutableUserAttributes() iter.Seq[ImmutableUserAttribute]
	// Token returned to ACS by the underlying identity provider. This field is set only in a few,
	// specific contexts. Do not rely on this field being present in the response.
	GetIdpToken() string
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *AuthStatus
}

// GetImmutableExpires implements ImmutableAuthStatus
func (m *AuthStatus) GetImmutableExpires() time.Time {
	if m == nil || m.Expires == nil {
		return time.Time{}
	}
	return m.Expires.AsTime()
}

// GetImmutableUserAttributes implements ImmutableAuthStatus
func (m *AuthStatus) GetImmutableUserAttributes() iter.Seq[ImmutableUserAttribute] {
	return func(yield func(ImmutableUserAttribute) bool) {
		if m == nil || m.UserAttributes == nil {
			return
		}
		for _, v := range m.UserAttributes {
			if !yield(v) {
				return
			}
		}
	}
}

// Verify that AuthStatus implements ImmutableAuthStatus
var _ ImmutableAuthStatus = (*AuthStatus)(nil)

// ImmutableAuthMachineToMachineConfig is an immutable interface for AuthMachineToMachineConfig
type ImmutableAuthMachineToMachineConfig interface {
	// UUID of the config.
	// Note that when adding a machine to machine config, this field should not be set.
	GetId() string
	GetType() AuthMachineToMachineConfig_Type
	// Sets the expiration of the token returned from the ExchangeAuthMachineToMachineToken API call.
	// Possible valid time units are: s, m, h.
	// The maximum allowed expiration duration is 24h.
	// As an example: 2h45m.
	// For additional information on the validation of the duration, see:
	// https://pkg.go.dev/time#ParseDuration.
	GetTokenExpirationDuration() string
	// At least one mapping is required to resolve to a valid role for the access token to be successfully generated.
	GetImmutableMappings() iter.Seq[ImmutableAuthMachineToMachineConfig_Mapping]
	// The issuer of the related OIDC provider issuing the ID tokens to exchange.
	//
	// Must be non-empty string containing URL when type is GENERIC.
	// In case of GitHub actions, this must be empty or set to https://token.actions.githubusercontent.com.
	//
	// Issuer is a unique key, therefore there may be at most one GITHUB_ACTIONS config, and each
	// GENERIC config must have a distinct issuer.
	GetIssuer() string
	GetImmutableTraits() ImmutableTraits
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *AuthMachineToMachineConfig
}

// GetImmutableMappings implements ImmutableAuthMachineToMachineConfig
func (m *AuthMachineToMachineConfig) GetImmutableMappings() iter.Seq[ImmutableAuthMachineToMachineConfig_Mapping] {
	return func(yield func(ImmutableAuthMachineToMachineConfig_Mapping) bool) {
		if m == nil || m.Mappings == nil {
			return
		}
		for _, v := range m.Mappings {
			if !yield(v) {
				return
			}
		}
	}
}

// GetImmutableTraits implements ImmutableAuthMachineToMachineConfig
func (m *AuthMachineToMachineConfig) GetImmutableTraits() ImmutableTraits {
	return m.GetTraits()
}

// Verify that AuthMachineToMachineConfig implements ImmutableAuthMachineToMachineConfig
var _ ImmutableAuthMachineToMachineConfig = (*AuthMachineToMachineConfig)(nil)

// ImmutableAuthMachineToMachineConfig_Mapping is an immutable interface for AuthMachineToMachineConfig_Mapping
type ImmutableAuthMachineToMachineConfig_Mapping interface {
	// A key within the identity token's claim value to use.
	GetKey() string
	// A regular expression that will be evaluated against values of the identity token claim
	// identified by the specified key.
	// This regular expressions is in RE2 format, see more here:
	// https://github.com/google/re2/wiki/Syntax.
	GetValueExpression() string
	// The role which should be issued when the key and value match for a particular identity token.
	GetRole() string
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *AuthMachineToMachineConfig_Mapping
}

// Verify that AuthMachineToMachineConfig_Mapping implements ImmutableAuthMachineToMachineConfig_Mapping
var _ ImmutableAuthMachineToMachineConfig_Mapping = (*AuthMachineToMachineConfig_Mapping)(nil)

// ImmutableListAuthMachineToMachineConfigResponse is an immutable interface for ListAuthMachineToMachineConfigResponse
type ImmutableListAuthMachineToMachineConfigResponse interface {
	GetImmutableConfigs() iter.Seq[ImmutableAuthMachineToMachineConfig]
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *ListAuthMachineToMachineConfigResponse
}

// GetImmutableConfigs implements ImmutableListAuthMachineToMachineConfigResponse
func (m *ListAuthMachineToMachineConfigResponse) GetImmutableConfigs() iter.Seq[ImmutableAuthMachineToMachineConfig] {
	return func(yield func(ImmutableAuthMachineToMachineConfig) bool) {
		if m == nil || m.Configs == nil {
			return
		}
		for _, v := range m.Configs {
			if !yield(v) {
				return
			}
		}
	}
}

// Verify that ListAuthMachineToMachineConfigResponse implements ImmutableListAuthMachineToMachineConfigResponse
var _ ImmutableListAuthMachineToMachineConfigResponse = (*ListAuthMachineToMachineConfigResponse)(nil)

// ImmutableGetAuthMachineToMachineConfigResponse is an immutable interface for GetAuthMachineToMachineConfigResponse
type ImmutableGetAuthMachineToMachineConfigResponse interface {
	GetImmutableConfig() ImmutableAuthMachineToMachineConfig
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *GetAuthMachineToMachineConfigResponse
}

// GetImmutableConfig implements ImmutableGetAuthMachineToMachineConfigResponse
func (m *GetAuthMachineToMachineConfigResponse) GetImmutableConfig() ImmutableAuthMachineToMachineConfig {
	return m.GetConfig()
}

// Verify that GetAuthMachineToMachineConfigResponse implements ImmutableGetAuthMachineToMachineConfigResponse
var _ ImmutableGetAuthMachineToMachineConfigResponse = (*GetAuthMachineToMachineConfigResponse)(nil)

// ImmutableAddAuthMachineToMachineConfigRequest is an immutable interface for AddAuthMachineToMachineConfigRequest
type ImmutableAddAuthMachineToMachineConfigRequest interface {
	GetImmutableConfig() ImmutableAuthMachineToMachineConfig
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *AddAuthMachineToMachineConfigRequest
}

// GetImmutableConfig implements ImmutableAddAuthMachineToMachineConfigRequest
func (m *AddAuthMachineToMachineConfigRequest) GetImmutableConfig() ImmutableAuthMachineToMachineConfig {
	return m.GetConfig()
}

// Verify that AddAuthMachineToMachineConfigRequest implements ImmutableAddAuthMachineToMachineConfigRequest
var _ ImmutableAddAuthMachineToMachineConfigRequest = (*AddAuthMachineToMachineConfigRequest)(nil)

// ImmutableAddAuthMachineToMachineConfigResponse is an immutable interface for AddAuthMachineToMachineConfigResponse
type ImmutableAddAuthMachineToMachineConfigResponse interface {
	GetImmutableConfig() ImmutableAuthMachineToMachineConfig
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *AddAuthMachineToMachineConfigResponse
}

// GetImmutableConfig implements ImmutableAddAuthMachineToMachineConfigResponse
func (m *AddAuthMachineToMachineConfigResponse) GetImmutableConfig() ImmutableAuthMachineToMachineConfig {
	return m.GetConfig()
}

// Verify that AddAuthMachineToMachineConfigResponse implements ImmutableAddAuthMachineToMachineConfigResponse
var _ ImmutableAddAuthMachineToMachineConfigResponse = (*AddAuthMachineToMachineConfigResponse)(nil)

// ImmutableUpdateAuthMachineToMachineConfigRequest is an immutable interface for UpdateAuthMachineToMachineConfigRequest
type ImmutableUpdateAuthMachineToMachineConfigRequest interface {
	GetImmutableConfig() ImmutableAuthMachineToMachineConfig
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *UpdateAuthMachineToMachineConfigRequest
}

// GetImmutableConfig implements ImmutableUpdateAuthMachineToMachineConfigRequest
func (m *UpdateAuthMachineToMachineConfigRequest) GetImmutableConfig() ImmutableAuthMachineToMachineConfig {
	return m.GetConfig()
}

// Verify that UpdateAuthMachineToMachineConfigRequest implements ImmutableUpdateAuthMachineToMachineConfigRequest
var _ ImmutableUpdateAuthMachineToMachineConfigRequest = (*UpdateAuthMachineToMachineConfigRequest)(nil)

// ImmutableExchangeAuthMachineToMachineTokenRequest is an immutable interface for ExchangeAuthMachineToMachineTokenRequest
type ImmutableExchangeAuthMachineToMachineTokenRequest interface {
	// Identity token that is supposed to be exchanged.
	GetIdToken() string
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *ExchangeAuthMachineToMachineTokenRequest
}

// Verify that ExchangeAuthMachineToMachineTokenRequest implements ImmutableExchangeAuthMachineToMachineTokenRequest
var _ ImmutableExchangeAuthMachineToMachineTokenRequest = (*ExchangeAuthMachineToMachineTokenRequest)(nil)

// ImmutableExchangeAuthMachineToMachineTokenResponse is an immutable interface for ExchangeAuthMachineToMachineTokenResponse
type ImmutableExchangeAuthMachineToMachineTokenResponse interface {
	// The exchanged access token.
	GetAccessToken() string
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *ExchangeAuthMachineToMachineTokenResponse
}

// Verify that ExchangeAuthMachineToMachineTokenResponse implements ImmutableExchangeAuthMachineToMachineTokenResponse
var _ ImmutableExchangeAuthMachineToMachineTokenResponse = (*ExchangeAuthMachineToMachineTokenResponse)(nil)
