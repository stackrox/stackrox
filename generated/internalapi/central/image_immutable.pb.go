// Code generated by protoc-gen-go-immutable. DO NOT EDIT.

package central

import (
	storage "github.com/stackrox/rox/generated/storage"
)

import (
	"iter"
)

// ImmutableScanImage is an immutable interface for ScanImage
type ImmutableScanImage interface {
	// request id is used to map scan results to a waiting goroutine.
	GetRequestId() string
	// full image name ie: <registry>/something/nginx:1.2.3.
	GetImageName() string
	// force will cause central and sensor caches to be ignored.
	GetForce() bool
	// namespace is used by sensor to pull additional secrets for registry authentication.
	GetNamespace() string
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *ScanImage
}

// Verify that ScanImage implements ImmutableScanImage
var _ ImmutableScanImage = (*ScanImage)(nil)

// ImmutableImageIntegrations is an immutable interface for ImageIntegrations
type ImmutableImageIntegrations interface {
	GetImmutableUpdatedIntegrations() iter.Seq[*storage.ImageIntegration]
	GetImmutableDeletedIntegrationIds() iter.Seq[string]
	// refresh when true indicates that the updated integrations should replace
	// any existing integrations.
	GetRefresh() bool
	// VT proto functions
	SizeVT() int
	MarshalVT() ([]byte, error)
	CloneVT() *ImageIntegrations
}

// GetImmutableUpdatedIntegrations implements ImmutableImageIntegrations
func (m *ImageIntegrations) GetImmutableUpdatedIntegrations() iter.Seq[*storage.ImageIntegration] {
	return func(yield func(*storage.ImageIntegration) bool) {
		if m == nil || m.UpdatedIntegrations == nil {
			return
		}
		for _, v := range m.UpdatedIntegrations {
			if !yield(v) {
				return
			}
		}
	}
}

// GetImmutableDeletedIntegrationIds implements ImmutableImageIntegrations
func (m *ImageIntegrations) GetImmutableDeletedIntegrationIds() iter.Seq[string] {
	return func(yield func(string) bool) {
		if m == nil || m.DeletedIntegrationIds == nil {
			return
		}
		for _, v := range m.DeletedIntegrationIds {
			if !yield(v) {
				return
			}
		}
	}
}

// Verify that ImageIntegrations implements ImmutableImageIntegrations
var _ ImmutableImageIntegrations = (*ImageIntegrations)(nil)
