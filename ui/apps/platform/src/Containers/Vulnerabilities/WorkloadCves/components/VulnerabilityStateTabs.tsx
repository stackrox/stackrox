import React from 'react';
import { Tabs, Tab, TabTitleText, TabsProps } from '@patternfly/react-core';

import { vulnerabilityStates } from 'types/cve.proto';
import useFeatureFlags from 'hooks/useFeatureFlags';
import useURLStringUnion from 'hooks/useURLStringUnion';

export type VulnerabilityStateTabsProps = {
    isBox?: TabsProps['isBox'];
    titleOverrides?: {
        observed?: string;
        deferred?: string;
        falsePositive?: string;
    };
};

function VulnerabilityStateTabs({ titleOverrides, isBox = false }: VulnerabilityStateTabsProps) {
    const { isFeatureFlagEnabled } = useFeatureFlags();
    const isUnifiedDeferralsEnabled = isFeatureFlagEnabled('ROX_VULN_MGMT_UNIFIED_CVE_DEFERRAL');
    const [vulnerabilityStateKey, setVulnerabilityStateKey] = useURLStringUnion(
        'vulnerabilityState',
        vulnerabilityStates
    );

    return isUnifiedDeferralsEnabled ? (
        <Tabs
            activeKey={vulnerabilityStateKey}
            onSelect={(_e, tab) => setVulnerabilityStateKey(tab)}
            component="nav"
            isBox={isBox}
        >
            <Tab
                eventKey="OBSERVED"
                title={<TabTitleText>{titleOverrides?.observed ?? 'Observed'}</TabTitleText>}
            />
            <Tab
                eventKey="DEFERRED"
                title={<TabTitleText>{titleOverrides?.deferred ?? 'Deferred'}</TabTitleText>}
            />
            <Tab
                eventKey="FALSE_POSITIVE"
                title={
                    <TabTitleText>
                        {titleOverrides?.falsePositive ?? 'False positives'}
                    </TabTitleText>
                }
            />
        </Tabs>
    ) : null;
}

export default VulnerabilityStateTabs;
