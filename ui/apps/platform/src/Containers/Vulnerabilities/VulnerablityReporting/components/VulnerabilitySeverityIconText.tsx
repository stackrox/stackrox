import React, { ReactElement } from 'react';
import { Flex, FlexItem } from '@patternfly/react-core';

import SeverityIcons from 'Components/PatternFly/SeverityIcons';
import { VulnerabilitySeverity } from 'types/cve.proto';
import { cveSeverityLabelMap } from '../utils';

const CriticalSeverityIcon = SeverityIcons.CRITICAL_VULNERABILITY_SEVERITY;
const ImportantSeverityIcon = SeverityIcons.IMPORTANT_VULNERABILITY_SEVERITY;
const ModerateSeverityIcon = SeverityIcons.MODERATE_VULNERABILITY_SEVERITY;
const LowSeverityIcon = SeverityIcons.LOW_VULNERABILITY_SEVERITY;

const cveSeverityIconMap: Record<VulnerabilitySeverity, ReactElement | null> = {
    UNKNOWN_VULNERABILITY_SEVERITY: null,
    CRITICAL_VULNERABILITY_SEVERITY: <CriticalSeverityIcon />,
    IMPORTANT_VULNERABILITY_SEVERITY: <ImportantSeverityIcon />,
    MODERATE_VULNERABILITY_SEVERITY: <ModerateSeverityIcon />,
    LOW_VULNERABILITY_SEVERITY: <LowSeverityIcon />,
};

export type VulnerabilitySeverityIconTextProps = {
    severity: VulnerabilitySeverity;
};

function VulnerabilitySeverityIconText({ severity }: VulnerabilitySeverityIconTextProps) {
    return (
        <Flex
            className="pf-u-mx-sm"
            spaceItems={{ default: 'spaceItemsSm' }}
            alignItems={{ default: 'alignItemsCenter' }}
        >
            <FlexItem>{cveSeverityIconMap[severity]}</FlexItem>
            <FlexItem>{cveSeverityLabelMap[severity]}</FlexItem>
        </Flex>
    );
}

export default VulnerabilitySeverityIconText;
