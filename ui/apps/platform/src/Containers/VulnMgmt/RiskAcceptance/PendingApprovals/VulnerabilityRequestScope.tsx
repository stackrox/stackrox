import React, { ReactElement } from 'react';

import { Scope } from 'types/vuln_request.proto';

export type VulnerabilityRequestScopeProps = {
    scope: Scope;
};

function VulnerabilityRequestScope({ scope }: VulnerabilityRequestScopeProps): ReactElement {
    let text = 'N/A';
    if (scope.imageScope) {
        const { registry, remote, tag, digest } = scope.imageScope;        
        text = digest !== '.*' ? `${registry}/${remote}:${digest}` : tag ? `${registry}/${remote}:${tag}` : `${registry}/${remote}`;
    }
    return <div>{text}</div>;
}

export default VulnerabilityRequestScope;
