load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")

go_library(
    name = "fake",
    srcs = [
        "common.go",
        "deployment.go",
        "fake.go",
        "flows.go",
        "labels.go",
        "namespace.go",
        "networkpolicy.go",
        "nodes.go",
        "openshift.go",
        "pebble.go",
        "pools.go",
        "process.go",
        "rbac.go",
        "service.go",
        "workload.go",
    ],
    importpath = "github.com/stackrox/rox/sensor/kubernetes/fake",
    visibility = ["//visibility:public"],
    deps = [
        "//generated/internalapi/sensor",
        "//generated/storage",
        "//pkg/concurrency",
        "//pkg/containerid",
        "//pkg/env",
        "//pkg/fixtures",
        "//pkg/k8srbac",
        "//pkg/k8sutil",
        "//pkg/kubernetes",
        "//pkg/logging",
        "//pkg/net",
        "//pkg/pointers",
        "//pkg/protocompat",
        "//pkg/set",
        "//pkg/stringutils",
        "//pkg/sync",
        "//pkg/timestamp",
        "//pkg/uuid",
        "//sensor/common/networkflow/manager",
        "//sensor/common/signal",
        "//sensor/kubernetes/client",
        "@com_github_cockroachdb_pebble_v2//:pebble",
        "@com_github_openshift_api//config/v1:config",
        "@com_github_openshift_client_go//apps/clientset/versioned",
        "@com_github_openshift_client_go//apps/clientset/versioned/fake",
        "@com_github_openshift_client_go//config/clientset/versioned",
        "@com_github_openshift_client_go//config/clientset/versioned/fake",
        "@com_github_openshift_client_go//operator/clientset/versioned",
        "@com_github_openshift_client_go//operator/clientset/versioned/fake",
        "@com_github_openshift_client_go//route/clientset/versioned",
        "@com_github_openshift_client_go//route/clientset/versioned/fake",
        "@in_yaml_go_yaml_v3//:yaml",
        "@io_k8s_api//apps/v1:apps",
        "@io_k8s_api//core/v1:core",
        "@io_k8s_api//networking/v1:networking",
        "@io_k8s_api//rbac/v1:rbac",
        "@io_k8s_apimachinery//pkg/api/resource",
        "@io_k8s_apimachinery//pkg/apis/meta/v1:meta",
        "@io_k8s_apimachinery//pkg/runtime",
        "@io_k8s_apimachinery//pkg/runtime/schema",
        "@io_k8s_apimachinery//pkg/types",
        "@io_k8s_apimachinery//pkg/util/intstr",
        "@io_k8s_apimachinery//pkg/version",
        "@io_k8s_apimachinery//pkg/watch",
        "@io_k8s_client_go//discovery/fake",
        "@io_k8s_client_go//dynamic",
        "@io_k8s_client_go//dynamic/fake",
        "@io_k8s_client_go//kubernetes",
        "@io_k8s_client_go//kubernetes/fake",
    ],
)

alias(
    name = "go_default_library",
    actual = ":fake",
    visibility = ["//visibility:public"],
)

go_test(
    name = "fake_test",
    srcs = ["flows_test.go"],
    embed = [":fake"],
    deps = [
        "//generated/storage",
        "//pkg/net",
        "@com_github_stretchr_testify//suite",
    ],
)
