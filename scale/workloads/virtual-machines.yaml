# Virtual Machine Workload Profile
# This workload generates fake VirtualMachine and VirtualMachineInstance CRD events
# to simulate KubeVirt workloads arriving through Kubernetes informers.
#
# Usage:
#   ROX_VIRTUAL_MACHINES=true go run tools/local-sensor/main.go -no-mem-prof -no-cpu-prof -with-metrics -with-fakeworkload scale/workloads/virtual-machines.yaml
#
# After running for some time and hitting Ctrl-C, check central-out.json for VM/VMI events.

nodeWorkload:
  numNodes: 50

numNamespaces: 20

rbacWorkload:
  numRoles: 100
  numServiceAccounts: 100
  numBindings: 100

# VirtualMachine workload configuration
virtualMachineWorkload:
  # Pool size: number of VM/VMI templates to maintain (memory-efficient bounded pool)
  poolSize: 50

  # How often to update VM/VMI metadata (annotations, labels, status)
  updateInterval: 30s

  # How long each VM/VMI lifecycle lasts before recreation
  lifecycleDuration: 10s

  # Number of times to recreate VMs/VMIs (0 = infinite)
  numLifecycles: 0

# Optional: small background deployment workload
deploymentWorkload:
- deploymentType: Deployment
  numDeployments: 10
  numLabels: 5
  numLifecycles: 0
  lifecycleDuration: 30m
  updateInterval: 5m
  podWorkload:
    numContainers: 1
    numPods: 2
    lifecycleDuration: 10m
    containerWorkload:
      numImages: 0
    processWorkload:
      processInterval: 60s
      alertRate: 0.001

networkWorkload:
  flowInterval: 60s
  batchSize: 50
  generateUnclosedEndpoints: true
  openPortReuseProbability: 0.05
