# VM Index Report Stress Test Workload
# This workload focuses on stress-testing the VM index report processing pipeline
# by generating a high volume of VM index reports with varying configurations.
# It includes a small background load from other system components to simulate
# a more realistic production environment.

deploymentWorkload:
- deploymentType: Deployment
  lifecycleDuration: 1h
  numDeployments: 200
  numLifecycles: 0
  podWorkload:
    containerWorkload:
      numImages: 0
    lifecycleDuration: 2m
    numContainers: 3
    numPods: 5
    processWorkload:
      alertRate: 0.001
      processInterval: 30s
  updateInterval: 10m
networkWorkload:
  batchSize: 100
  flowInterval: 30s
  generateUnclosedEndpoints: true
  openPortReuseProbability: 0.05
nodeWorkload:
  numNodes: 100
rbacWorkload:
  numBindings: 100
  numRoles: 100
  numServiceAccounts: 100

vmIndexReportWorkload:
  # Number of VMs to simulate
  # Each VM will have a unique ID and VSOCK CID
  numVMs: 10000

  # Interval between reports for each VM
  # Lower values = higher load (e.g., 100ms = 10 reports/second per VM)
  # With 1000 VMs at 100ms interval, this generates ~10,000 reports/second total
  reportInterval: 60s

  # Number of packages to include in each IndexReport
  # Higher values = larger message size and more processing overhead
  numPackages: 1000

  # Number of repositories to include in each IndexReport
  # Higher values = larger message size and more processing overhead
  numRepositories: 500
