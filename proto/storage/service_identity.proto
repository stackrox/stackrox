syntax = "proto3";

option go_package = "storage";
option java_package = "io.stackrox.proto.storage";

package storage;

message ServiceIdentity {
    oneof srl {
        int64       serial     = 1 [deprecated = true];
        string      serial_str = 4;  // The serial number in decimal representation.
    }
    string      id             = 2;
    ServiceType type           = 3;
    string      init_bundle_id = 5;
}

enum ServiceType {
    UNKNOWN_SERVICE           = 0;
    SENSOR_SERVICE            = 1;
    CENTRAL_SERVICE           = 2;
    REMOTE_SERVICE            = 3;
    COLLECTOR_SERVICE         = 4;
    MONITORING_UI_SERVICE     = 5;
    MONITORING_DB_SERVICE     = 6;
    MONITORING_CLIENT_SERVICE = 7;
    BENCHMARK_SERVICE         = 8;
    SCANNER_SERVICE           = 9;
    SCANNER_DB_SERVICE        = 10;
    ADMISSION_CONTROL_SERVICE = 11;
}

message ServiceCertificate {
    bytes cert_pem = 1;
    bytes key_pem  = 2;
}

message TypedServiceCertificate {
    ServiceType service_type = 1;
    ServiceCertificate cert  = 2;
}

message TypedServiceCertificateSet {
    bytes ca_pem   = 1;
    repeated TypedServiceCertificate service_certs = 2;
}
