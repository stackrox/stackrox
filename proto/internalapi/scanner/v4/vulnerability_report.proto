// This contains protobuf types in pair with ClairCore's types, with
// minimal differences. See https://github.com/quay/claircore for comments
// on the fields.

syntax = "proto3";

package scanner.v4;

import "google/protobuf/timestamp.proto";
import "internalapi/scanner/v4/common.proto";

option go_package = "v4";

message VulnerabilityReport {
    message Vulnerability {
        enum Severity {
            SEVERITY_UNSPECIFIED = 0;
            SEVERITY_LOW         = 1;
            SEVERITY_MODERATE    = 2;
            SEVERITY_IMPORTANT   = 3;
            SEVERITY_CRITICAL    = 4;
        };
        string                    id                  = 1;
        string                    name                = 3;
        string                    description         = 4;
        google.protobuf.Timestamp issued              = 5;
        string                    link                = 6;
        string                    severity            = 7;
        Severity                  normalized_severity = 8;
        string                    package_id          = 9;
        string                    distribution_id     = 10;
        string                    repository_id       = 11;
        string                    fixed_in_version    = 12;
    }

    string                     hash_id                 = 1;
    map<string, Vulnerability> vulnerabilities         = 2;
    map<string, StringList>    package_vulnerabilities = 3;
    Contents                   contents                = 4;
}

message StringList {
    repeated string values = 1;
}
